!function($){"use strict";theme.ProductsView=function(){function a(){this.selectors={view:".js-products-view"},$(this.selectors.view).length&&this.init()}a.prototype=$.extend({},a.prototype,{init:function(){var a=this,e=localStorage.getItem("products-view");if(-1!==window.location.href.indexOf("products-view=reset")&&(e=null,localStorage.setItem("products-view",null)),e){var t=$(this.selectors.view+" [data-js-products-grid-buttons]");e=JSON.parse(e),t.each(function(){var t=$(this),n=!0;$.each(e,function(a,e){if(t.attr("data-value-"+a)!==e){var r="data-active-"+a;t.attr("data-value-"+a,e),t.find("[data-value]").removeAttr(r),t.find('[data-value="'+e+'"]').attr(r,!0),n=!1}}),n||a.update(t)})}$body.on("click",this.selectors.view+" [data-js-products-grid-buttons] [data-value]",function(){var e=$(this),t=e.parents("[data-js-products-grid-buttons]"),n=e.attr("data-value"),r=theme.current.bp,o="data-active-"+r;if(!e[0].hasAttribute(o)){var l={};t.find("[data-value]").removeAttr(o),e.attr(o,!0),t.attr("data-value-"+r,n),a.update(t),$.each(theme.breakpoints.values,function(a,e){l[a]=t.attr("data-value-"+a)}),localStorage.setItem("products-view",JSON.stringify(l))}})},update:function(a){var e=a.parents(this.selectors.view).find("[data-js-products]"),t=$("[data-js-products-grid-buttons]"),n="";t.length&&($.each(theme.breakpoints.values,function(a){var r=t.attr("data-value-"+a),o="list"===r?12:12/+r;e[1==+r?"addClass":"removeClass"]("products-view-centered-"+a),e["list"===r?"addClass":"removeClass"]("products-view-list-"+a),n+=" col-","xs"!==a&&(n+=a+"-"),n+=o}),e.find("[data-js-product]").parent().attr("class",n),$window.trigger("checkImages"))}}),theme.ProductsView=new a},theme.Collections=function(){function Collections(){var a=$(".js-collections");this.dom={$collections:a,$body:a.find("[data-js-collections-body]"),$sidebar:$("[data-js-collection-sidebar]"),$pagination:a.find("[data-js-collection-pagination]")},this.current={xhr:null,handle:null},this.dom.$collections.length&&this.load()}Collections.prototype=$.extend({},Collections.prototype,{_parseURL:function(){var a=window.location.href.split(theme.routes.collections_url+"/")[1].split("?"),e=a[0].split("/"),t=a[1]?a[1].split("&"):void 0,n={handle:e[0],params:{tags:[],vendors:[],types:[],options:[],title:null,price_from:null,price_to:null,only_available_enable:null,only_preorder_enable:null,logic_or_enable:null,page:null,view:null,sort_by:null}};return e[1]&&(n.params.tags=n.params.tags.concat(e[1].split("+"))),$.each(t,function(a,e){var t=e.split("="),r=t[0],o=t[1];"constraint"===r?o.split("+").map(function a(e){n.params.tags.push(decodeURIComponent(e.replace(/-/g," ")))}):"q"===r?$.each(o.split("+"),function(a,e){var t=e.split("_:"),r=t[0],o=t[1];"tg"===r?n.params.tags.push(decodeURIComponent(o)):"vd"===r?n.params.vendors.push(decodeURIComponent(o)):"tp"===r?n.params.types.push(decodeURIComponent(o)):"opt"===r?(o=o.split("::"),n.params.options.push(decodeURIComponent(o[0])+"::"+decodeURIComponent(o[1]))):"tt"===r?n.params.title=decodeURIComponent(o):"prf"===r?n.params.price_from=o:"prt"===r?n.params.price_to=o:"oa"===r?n.params.only_available_enable="true"===o||"false"!==o&&null:"po"===r?n.params.only_preorder_enable="true"===o||"false"!==o&&null:"lo"===r?n.params.logic_or_enable="true"===o||"false"!==o&&null:"pg"===r&&(n.params.page=o)}):"view"===r?n.params.view=o:"sort_by"===r?n.params.sort_by=o:"page"===r&&(n.params.page=o)}),n},_buildURL:function(a){var e=theme.routes.collections_url+"/"+a.handle,t=e,n=[],r=[];function o(a,e){for(var t,n=[],r=0;r<a.length;r++)e?(t=a[r].split(e),n[r]=encodeURIComponent(t[0])+e+encodeURIComponent(t[1])):n[r]=encodeURIComponent(a[r]);return n}return!0===window.page.default.only_available||!0===window.page.default.logic_or||a.params.vendors.length||a.params.types.length||a.params.options.length||null!==a.params.title||null!==a.params.price_from||null!==a.params.price_to||null!=a.params.only_available_enable||null!=a.params.only_preorder_enable||null!=a.params.logic_or_enable?(n[0]=[],a.params.tags.length&&n[0].push("tg_:"+o(a.params.tags).join("+tg_:")),a.params.vendors.length&&n[0].push("vd_:"+o(a.params.vendors).join("+vd_:")),a.params.types.length&&n[0].push("tp_:"+o(a.params.types).join("+tp_:")),a.params.options.length&&n[0].push("opt_:"+o(a.params.options,"::").join("+opt_:")),null!==a.params.title&&n[0].push("tt_:"+encodeURIComponent(a.params.title)),null!==a.params.price_from&&n[0].push("prf_:"+a.params.price_from),null!==a.params.price_to&&n[0].push("prt_:"+a.params.price_to),null!==a.params.only_available_enable&&a.params.only_available_enable!==window.page.default.only_available&&n[0].push("oa_:"+a.params.only_available_enable),null!==a.params.only_preorder_enable&&a.params.only_preorder_enable!==window.page.default.only_available&&n[0].push("po_:"+a.params.only_preorder_enable),null!==a.params.logic_or_enable&&a.params.logic_or_enable!==window.page.default.logic_or&&n[0].push("lo_:"+a.params.logic_or_enable),null!==a.params.page&&1!==a.params.page&&n[0].push("pg_:"+a.params.page),n[0].length?n[0]="q="+n[0].join("+"):n=[]):(a.params.tags.length&&n.push("constraint="+o(a.params.tags.map(function(a){return a.replace(/ /g,"-")})).join("+")),null!==a.params.page&&1!==a.params.page&&n.push("page="+a.params.page)),null!==a.params.sort_by&&a.params.sort_by!==window.page.default.sort_by&&n.push("sort_by="+a.params.sort_by),r=n.slice(),null!==a.params.view&&a.params.view!==window.page.default.view_length?(n.push("view="+a.params.view),r.push("view="+a.params.view+"-ajax")):r.push("view=ajax"),n.length&&(e+="?"+n.join("&")),{history:e,ajax:t+="?"+r.join("&")}},_changeURL:function(a,e){("onchange.pagination"!==e||"button_load_more"!==window.page.default.pagination_type&&"infinite_scroll"!==window.page.default.pagination_type)&&history.pushState({foo:"filters"},a,a)},_changeObj:function(a,e,t,n){var r,o=$.extend(!0,{},a),l=o;return -1!==e.indexOf("params.")&&(l=o.params,e=e.replace("params.","")),"change"===t?l[e]=n:"add"===t?-1===l[e].indexOf(n)&&l[e].push(n):"remove"===t&&-1!==(r=l[e].indexOf(n))&&l[e].splice(r,1),o},_setControls:function(a){var e=window.page.default.only_available,t=window.page.default.logic_or,n=window.page.default.only_available;null!==a.params.only_available_enable&&(e=a.params.only_available_enable),null!==a.params.only_preorder_enable&&(n=a.params.only_preorder_enable),null!==a.params.logic_or_enable&&(t=a.params.logic_or_enable),$('[name="collection"]').prop("checked",!1).filter('[value="'+a.handle+'"]').prop("checked","checked"),$('[name="collection_with_tag"], [name="filter_by_tag"], [name="filter_by_color"], [name="filter_by_vendor"], [name="filter_by_type"], [name="filter_by_option"]').prop("checked",!1),$('[name="filter_by_title"]').val(""),theme.RangeOfPrice&&theme.RangeOfPrice.reset(),$.each(a.params.tags,function(a,e){$('[name="collection_with_tag"][value="'+e+'"]').prop("checked","checked"),$('[name="filter_by_tag"][value="'+e+'"]').prop("checked","checked"),$('[name="filter_by_color"][value="'+e+'"]').prop("checked","checked")}),$.each(a.params.vendors,function(a,e){$('[name="filter_by_vendor"][value="'+e+'"]').prop("checked","checked")}),$.each(a.params.types,function(a,e){$('[name="filter_by_type"][value="'+e+'"]').prop("checked","checked")}),$.each(a.params.options,function(a,e){$('[name="filter_by_option"][value="'+e+'"]').prop("checked","checked")}),$('[name="filter_by_title"]').val(a.params.title?a.params.title:""),$('[name="only_available"]').prop("checked",!!e&&"checked"),$('[name="only_preorder"]').prop("checked",!!n&&"checked"),$('[name="logic_or"]').prop("checked",!!t&&"checked"),$('[name="sort_by"]').val(null!==a.params.sort_by?a.params.sort_by:window.page.default.sort_by).trigger("update"),$('[name="view_length"]').val(null!==a.params.view?a.params.view:window.page.default.view_length).trigger("update"),theme.RangeOfPrice&&theme.RangeOfPrice.update(a.params.price_from,a.params.price_to)},_loadContent:function(url,obj,event){var _=this;this.current.xhr&&this.current.xhr.abort(),theme.Loader.set($('[data-js-collection-replace="products"]').parent(),{fixed:!0,spinner:!theme.current.is_mobile&&null}),this.xhr=$.ajax({type:"GET",url:url,cache:!1,dataType:"html",success:function(data){var parser,$new_page=$(new DOMParser().parseFromString(data,"text/html")),replace_find="[data-js-collection-replace]";theme.ProductsView&&theme.ProductsView.update($new_page.find("[data-js-products]")),_.current.handle===obj.handle&&(replace_find+=":not([data-js-collection-replace-only-full])"),theme.StickySidebar&&theme.StickySidebar.update("listener-enable"),$(replace_find).each(function(){var $this,$section,name=$(this).attr("data-js-collection-replace"),$element=$('[data-js-collection-replace="'+name+'"]'),$page_element=$new_page.find('[data-js-collection-replace="'+name+'"]');"onchange.pagination"===event&&"products"===name&&("button_load_more"===window.page.default.pagination_type||"infinite_scroll"===window.page.default.pagination_type)?($element.append($page_element.children()),"products"===name&&theme.Loader.unset($element.parent())):($element.replaceWith($page_element),$page_element[0].hasAttribute("data-js-collection-manual-visible")&&$page_element.parents("[data-js-collection-manual-visible-section]")["true"===$page_element.attr("data-js-collection-manual-visible")?"removeClass":"addClass"]("d-none-important"),$page_element[0].hasAttribute("data-js-collection-replace-hide-empty")&&($section=$page_element.parents("[data-js-collection-nav-section]"))[$page_element.find("input, [data-filter-type]").length?"removeClass":"addClass"]("d-none"),"fullwidth-head"===name||"head"===name?$page_element.parents("[data-section-type]").trigger("section:reload"):"products"===name?theme.Loader.unset($page_element.parent()):"js-settings"==name&&eval($page_element.text()),$element.remove())}),_.current.handle!==obj.handle&&($new_page.find("[data-js-collection-visible-element]").each(function(){var a=$(this);$('[data-js-collection-visible-element="'+a.attr("data-js-collection-visible-element")+'"]')["true"===a.attr("data-js-collection-visible")?"removeClass":"addClass"]("d-none-important")}),null===obj.params.sort_by&&_.dom.$body.find('[name="sort_by"]').val(window.page.default.sort_by).trigger("update"),null===obj.params.view&&_.dom.$body.find('[name="view_length"]').val(window.page.default.view_length).trigger("update")),_.dom.$pagination=_.dom.$body.find("[data-js-collection-pagination]"),theme.StickySidebar&&theme.StickySidebar.update("listener-process"),theme.StickySidebar&&theme.StickySidebar.update("listener-disable"),theme.current.is_mobile&&theme.Loader.unset(_.dom.$sidebar),theme.ImagesLazyLoad.update(),theme.ProductCurrency.update(),theme.StoreLists.checkProductStatus(),theme.ProductCountdown.init(_.dom.$body.find(".js-countdown")),theme.ProductReview.update(),theme.Tooltip&&theme.Tooltip.init(),$new_page.remove(),_.current.handle=obj.handle,_.current.xhr=null}})},_onChangeHistory:function(a){var e=this._buildURL(a);theme.current.is_mobile&&theme.Loader.set(this.dom.$sidebar,{fixed:!0}),this._setControls(a),this._loadContent(e.ajax,a)},_onChangeControls:function(a,e){var t=this._buildURL(a);theme.current.is_mobile&&theme.Loader.set(this.dom.$sidebar,{fixed:!0}),!0===window.page.default.reload_type_ajax?(this._changeURL(t.history,e),this._loadContent(t.ajax,a,e)):window.location.href=t.history},changePriceParams:function(a,e){var t=this._parseURL(),n=$.extend(!0,{},t);n=this._changeObj(n,"params.price_from","change",a),n=this._changeObj(n,"params.price_to","change",e),this._onChangeControls(n)},load:function(){var a=this;function e(e,t){var n=a._parseURL(),r=$.extend(!0,{},n),o=a.dom.$sidebar.find('[name="collection"]:checked').val();r=a._changeObj(r,"handle","change",o),r=a._changeObj(r,"params.page","change",null),e?(r=a._changeObj(r,"params.tags","change",[]),r=a._changeObj(r,"params.vendors","change",[]),r=a._changeObj(r,"params.types","change",[]),r=a._changeObj(r,"params.options","change",[]),r=a._changeObj(r,"params.title","change",null),r=a._changeObj(r,"params.price_from","change",null),r=a._changeObj(r,"params.price_to","change",null),$("[data-js-collection-current-tags] [data-filter-type]").remove(),$('[name="collection_with_tag"], [name="filter_by_tag"], [name="filter_by_color"], [name="filter_by_vendor"], [name="filter_by_type"], [name="filter_by_option"]').prop("checked",!1),$('[name="filter_by_title"]').val(""),theme.RangeOfPrice&&theme.RangeOfPrice.reset()):a.dom.$sidebar.find('[name="collection_with_tag"]').each(function(){var e=$(this),t=e.val();r=e.is(":checked")?a._changeObj(r,"params.tags","add",t):a._changeObj(r,"params.tags","remove",t)}),t&&t(r),a._onChangeControls(r)}function t(){var e=a._parseURL(),t=$.extend(!0,{},e),n=a.dom.$sidebar.find('[name="filter_by_title"]').val();t=a._changeObj(t,"params.page","change",null),t=n.length?a._changeObj(t,"params.title","change",n):a._changeObj(t,"params.title","change",null),a._onChangeControls(t)}this.dom.$sidebar.on("change",'[name="collection"]',function(){e(!0)}),this.dom.$sidebar.on("change",'[name="collection_with_tag"]',function(){var t=$(this),n=t.parents(".collections-menu__item").find('[name="collection"]'),r=$('[name="collection"]').not(n),o=n.is(":checked");r.prop("checked",!1),n.prop("checked","checked"),e(!o,function(e){o||(t.prop("checked","checked"),e=$.extend(!0,e,a._changeObj(e,"params.tags","add",t.val())))})}),this.dom.$sidebar.on("change",'[name="filter_by_tag"], [name="filter_by_color"]',function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this),r=n.val();t=a._changeObj(t,"params.page","change",null),t=n.is(":checked")?a._changeObj(t,"params.tags","add",r):a._changeObj(t,"params.tags","remove",r),a._onChangeControls(t)}),this.dom.$sidebar.on("change",'[name="filter_by_tag_98"]',function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this),r=n.val();if(t=a._changeObj(t,"params.page","change",null),n.hasClass("input-player-checked"))n.removeClass("input-player-checked"),$(".js-collection-banner-journey").removeAttr("data-filter"),t=a._changeObj(t,"params.tags","remove",r);else{var o=n.attr("data-banner");if(console.log(o),$(".input-player-checked").length>0){var l=$(".input-player-checked").val();t=a._changeObj(t,"params.tags","remove",l),$(".input-player-checked").removeClass("input-player-checked")}n.addClass("input-player-checked"),$(".js-collection-banner-journey").attr("data-filter",o),t=a._changeObj(t,"params.tags","add",r)}a._onChangeControls(t)}),this.dom.$sidebar.on("change",'[name="filter_by_vendor"]',function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this),r=n.val();t=a._changeObj(t,"params.page","change",null),t=n.is(":checked")?a._changeObj(t,"params.vendors","add",r):a._changeObj(t,"params.vendors","remove",r),a._onChangeControls(t)}),this.dom.$sidebar.on("change",'[name="filter_by_type"]',function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this),r=n.val();$('.filter-type-trigger[data-value="'+r+'"]').toggleClass("active"),t=a._changeObj(t,"params.page","change",null),t=n.is(":checked")?a._changeObj(t,"params.types","add",r):a._changeObj(t,"params.types","remove",r),a._onChangeControls(t)}),$(".js-clear-all-type").on("click",function(){var e=a._parseURL(),t=$.extend(!0,{},e);$(".filter-type-trigger").removeClass("active"),$(this).addClass("active"),t=a._changeObj(t,"params.types","change",[]),a._setControls(t),a._onChangeControls(t)}),this.dom.$sidebar.on("change",'[name="filter_by_option"]',function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this),r=n.val();t=a._changeObj(t,"params.page","change",null),t=n.is(":checked")?a._changeObj(t,"params.options","add",r):a._changeObj(t,"params.options","remove",r),a._onChangeControls(t)}),this.dom.$sidebar.on("change",'[name="only_available"]',function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this);t=a._changeObj(t,"params.page","change",null),t=a._changeObj(t,"params.only_available_enable","change",n.is(":checked")),a._onChangeControls(t)}),this.dom.$sidebar.on("change",'[name="only_preorder"]',function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this);t=a._changeObj(t,"params.page","change",null),t=a._changeObj(t,"params.only_preorder_enable","change",n.is(":checked")),console.log("change"),a._onChangeControls(t)}),this.dom.$sidebar.on("change",'[name="logic_or"]',function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this);t=a._changeObj(t,"params.page","change",null),t=a._changeObj(t,"params.logic_or_enable","change",n.is(":checked")),a._onChangeControls(t)}),this.dom.$sidebar.on("click","[data-js-collection-filter-by-title] button",function(){t()}),this.dom.$sidebar.on("keyup","[data-js-collection-filter-by-title] input",$.debounce(700,function(){t()})),this.dom.$sidebar.on("click","[data-js-collection-current-tags] [data-filter-type]",function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this),r=$(this).attr("data-filter-type"),o=n.attr("data-value");t=a._changeObj(t,"params.page","change",null),"tg"===r?t=a._changeObj(t,"params.tags","remove",o):"vd"===r?t=a._changeObj(t,"params.vendors","remove",o):"tp"===r?($('.filter-type-trigger[data-value="'+o+'"]').toggleClass("active"),t=a._changeObj(t,"params.types","remove",o)):"opt"===r?t=a._changeObj(t,"params.options","remove",o):"tt"===r?t=a._changeObj(t,"params.title","change",null):"pr"===r&&(t=a._changeObj(t,"params.price_from","change",null),t=a._changeObj(t,"params.price_to","change",null)),a._setControls(t),a._onChangeControls(t),n.remove()}),this.dom.$sidebar.on("click","[data-js-collection-current-tags-clear]",function(){var e=a._parseURL(),t=$.extend(!0,{},e);$(".filter-type-trigger").removeClass("active"),t=a._changeObj(t,"params.tags","change",[]),t=a._changeObj(t,"params.vendors","change",[]),t=a._changeObj(t,"params.types","change",[]),t=a._changeObj(t,"params.options","change",[]),t=a._changeObj(t,"params.title","change",null),t=a._changeObj(t,"params.price_from","change",null),t=a._changeObj(t,"params.price_to","change",null),t=a._changeObj(t,"params.page","change",null),a._setControls(t),a._onChangeControls(t),a.dom.$sidebar.find("[data-js-collection-current-tags] [data-filter-type]").remove()}),this.dom.$body.on("change","[data-js-collection-sort-by] select",function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this);t=a._changeObj(t,"params.page","change",null),t=a._changeObj(t,"params.sort_by","change",n.val()),a._onChangeControls(t)}),this.dom.$body.on("change","[data-js-collection-view-length] select",function(){var e=a._parseURL(),t=$.extend(!0,{},e),n=$(this);t=a._changeObj(t,"params.page","change",null),t=a._changeObj(t,"params.view","change",n.val()),a._onChangeControls(t)}),this.dom.$body.on("click","[data-js-collection-pagination] a",function(e){var t,n=a._parseURL(),r=$.extend(!0,{},n),o=$(this),l=o.attr("data-value")||o.attr("href").split("page=")[1].split("&")[0];return $('[name="page"]').val(l),r=a._changeObj(r,"params.page","change",l>1?l:null),a._onChangeControls(r,"onchange.pagination"),"button_load_more"!==window.page.default.pagination_type&&"infinite_scroll"!==window.page.default.pagination_type&&!0===window.page.default.reload_type_ajax&&(t=theme.StickyHeader&&theme.StickyHeader.$sticky?theme.StickyHeader.$sticky.stickyHeader("getStickyHeight"):0,$html.add($body).velocity("stop").velocity("scroll",{offset:a.dom.$body.find("[data-js-products]").offset().top-t,duration:1e3*theme.animations.pagination.scroll_duration})),e.preventDefault(),!1}),this.dom.$pagination.length&&"infinite_scroll"===window.page.default.pagination_type&&setTimeout(function(){$window.on("scroll",function(){a.dom.$pagination[0].getBoundingClientRect().top<theme.current.height&&!a.dom.$pagination[0].hasAttribute("data-js-loading")&&(a.dom.$pagination.attr("data-js-loading",!0),a.dom.$pagination.find("a").trigger("click"))})},500),!0===window.page.default.reload_type_ajax&&$window.on("popstate",function(){var e=a._parseURL();a._onChangeHistory(e)})}}),theme.Collections=new Collections},$(function(){theme.ProductsView(),theme.Collections()})}(jQueryTheme);