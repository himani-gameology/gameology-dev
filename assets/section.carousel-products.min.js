!function(t){"use strict";theme.CarouselProducts=function(){function i(i){this.$container=t(i),this.settings={arrows:!0},this.namespace=".carousel-products",this.onLoad()}return i.prototype=t.extend({},Section.prototype,i.prototype,{onLoad:function(){var i,s,e=this,o=this.$container.find(".product-recommendations");Loader.loadManually([{type:"styles",name:"plugin_slick"},{type:"scripts",name:"plugin_slick"}],function(){o.length?(i=o.attr("data-product-id"),s=o.attr("data-limit"),t.ajax({type:"GET",url:theme.routes.root_url+"recommendations/products",data:{section_id:"carousel-related-products",product_id:i,limit:s},success:function(i){o.html(t(i).find(".product-recommendations").html()),e.initCarousel(),theme.ImagesLazyLoad.update(),theme.ProductCurrency.update(),theme.ProductCountdown.init(o.find(".js-countdown").removeClass("js-countdown--lazy")),theme.ProductReview.update(),theme.Tooltip&&theme.Tooltip.init()}})):e.initCarousel()})},initCarousel:function(){var i=this;this.$slick=this.$container.find("[data-js-carousel-slick]"),this.$slick.length&&(this.$slider=this.$container.find("[data-js-carousel]"),this.$collections_ajax=this.$container.find("[data-carousel-ajax] [data-collection]"),this.$products=this.$container.find("[data-carousel-items]"),this.$slides=this.$slick.find("> *"),this.$prev=this.$slider.find("[data-js-carousel-prev]"),this.$next=this.$slider.find("[data-js-carousel-next]"),this.$control=this.$container.find("[data-carousel-control]"),this.settings.arrows="true"===this.$slider.attr("data-arrows"),this.settings.bullets="true"===this.$slider.attr("data-bullets"),this.settings.count=+this.$slider.attr("data-count"),this.settings.infinite="true"===this.$slider.attr("data-infinite"),this.settings.autoplay="true"===this.$slider.attr("data-autoplay"),this.settings.speed=+this.$slider.attr("data-speed")||0,this.settings.arrows&&$window.on("theme.resize.carousel-products",function(){i.arrowsPosition()}),this.$collections_ajax.length?this.loadProducts(this.$collections_ajax.first()):this.initSlick(),this.$control.on("click","a",function(s){var e=t(this);return e.hasClass("active")||i.loadProducts(e,!0),s.preventDefault(),!1}))},arrowsPosition:function(){var i=0;this.$slick.find(".carousel__item img").each(function(){i=Math.max(i,t(this).innerHeight())}),this.$prev.add(this.$next).css({top:i/2})},initSlick:function(){var t=this;this.$slick.one("init",function(){t.settings.arrows&&t.arrowsPosition(),$window.trigger("checkImages"),t.$slider.removeClass("invisible"),theme.Loader.unset(t.$slider.parent())}),this.$slick.on("beforeChange",function(i,s,e,o){function a(i){t.$slides.unbind("loaded"),i.one("loaded",function(){theme.ProductReview.update()})}var n=o-1,r=o+t.settings.count;t._checkProduct(t.$slick.find('[data-slick-index="'+n+'"]'),a);for(var l=r;l>e+1;l--)t._checkProduct(t.$slick.find('[data-slick-index="'+l+'"]'),a)}),this.$slick.on("afterChange",function(){theme.Tooltip&&theme.Tooltip.init()}),this.$slick.one("init",function(){t.$slider.addClass("initialized")}),this.$slick.slick({lazyLoad:!1,arrows:this.settings.arrows,prevArrow:this.$prev,nextArrow:this.$next,dots:this.settings.bullets,dotsClass:"slick-dots d-flex flex-wrap flex-center list-unstyled mt-7",adaptiveHeight:!0,autoplay:this.settings.autoplay,autoplaySpeed:this.settings.speed,infinite:this.settings.infinite,slidesToShow:this.settings.count,slidesToScroll:this.settings.count,touchMove:!1,rtl:theme.rtl,responsive:[{breakpoint:theme.breakpoints.values.xl,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:theme.breakpoints.values.md,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:theme.breakpoints.values.sm,settings:{slidesToShow:2,slidesToScroll:2}}]})},loadProducts:function(i,s){this.xhr&&this.xhr.abort();var e=this;s&&(theme.Loader.set(this.$slider.parent()),this.$slider.css({"min-height":this.$slider.innerHeight()}));var o=i.attr("data-collection");this.xhr=t.ajax({type:"GET",url:theme.routes.root_url+"collections/"+o,cache:!1,data:{view:"carousel",max_count:this.$products.attr("data-max-count"),size_of_columns:this.$products.attr("data-products-pre-row"),async_ajax_loading:this.$products.attr("data-async-ajax-loading")},dataType:"html",success:function(t){e.$slider.addClass("invisible"),e.$slick.hasClass("slick-initialized")&&e.$slick.slick("destroy").off(),e.$slick.one("init",function(){e.$slider.removeAttr("style"),s&&theme.Loader.unset(e.$slider.parent())}),e.$products.html(t),e.$slides=e.$slick.find("> *"),e.initSlick(),theme.ImagesLazyLoad.update(),theme.ProductCurrency.update(),theme.ProductCountdown.init(e.$products.find(".js-countdown").removeClass("js-countdown--lazy")),theme.ProductReview.update(),theme.Tooltip&&theme.Tooltip.init(),e.$control.find("a").removeClass("active"),i.addClass("active"),e.xhr=null}})},_checkProduct:function(i,s){var e=this,o=i.attr("data-handle");return!!o&&(s&&s(i),t.ajax({type:"GET",url:theme.routes.root_url+"products/"+o,data:{view:"collection"},cache:!1,dataType:"html",success:function(s){var a=t(s);i.add(e.$slick.find('.slick-cloned[data-handle="'+o+'"]')).html(a).removeAttr("data-handle"),theme.ImagesLazyLoad.update(),theme.ProductCountdown.init(i.find(".js-countdown").removeClass("js-countdown--lazy")),i.trigger("loaded")}}),!0)},onUnload:function(){this.$container.off(this.namespace),this.$slick&&(this.$slick.slick("destroy").off(),this.$slick=null,$window.unbind("theme.resize.carousel-products")),this.$control.off()}}),i}(),t(function(){theme.sections.register("carousel-products",theme.CarouselProducts)})}(jQueryTheme);