!function(t){"use strict";theme.StickySidebar=function(){function e(){this.settings={offset:15,min_height_diff:100},this.current={scroll:0},this.load()}e.prototype=t.extend({},e.prototype,{load:function(){var e=this,s=t(".js-popup"),o=s.find(".popup-quick-view");this._getSidebars(),theme.Global.responsiveHandler({namespace:".sticky-sidebar",element:$window,on_desktop:!0,onbindload:!0,onunbind_func:function(){t.each(e.sidebars,function(t,s){e._resetSidebar(s)})},events:{"theme.resize.sticky-sidebar scroll.sticky-sidebar sticky-sidebar.update":function(){e.update()}}}),o.length&&theme.Global.responsiveHandler({namespace:".sticky-sidebar",element:t(".js-popup"),on_desktop:!0,onbindload:!0,events:{"scroll.sticky-sidebar":function(){e.update(null,o[0].getBoundingClientRect().top*-1+31)}}})},reload:function(){this._getSidebars(),this.update()},_getSidebars:function(){var e=this;this.sidebars=[],t(".js-sticky-sidebar").each(function(){var s=t(this),o=s.find("[data-js-sticky-sidebar-body]");e.sidebars.push({$elem:s,$parent:s.parent(),$body:o,state:null,disable_offsets:!!o[0].hasAttribute("data-js-disable-offsets")})})},_resetSidebar:function(t){t.$elem.removeClass("sidebar-fixed-bottom sidebar-static-bottom sidebar-fixed-top sidebar-offset-top"),t.$body.removeAttr("style")},_startAction:function(t,e,s){e.state!==t&&(s(),e.state=t)},update:function(e,s){if(theme.current.is_desktop){if("listener-enable"===e)this.fixed=!0;else if("listener-disable"===e)return void(this.fixed=null);s=s?s:window.scrollY;var o=this,i=theme.StickyHeader&&theme.StickyHeader.$sticky?Math.ceil(theme.StickyHeader.$sticky.stickyHeader("getStickyHeight")):0,r=theme.ProductFootbar&&theme.ProductFootbar.$footbar?Math.ceil(theme.ProductFootbar.getFootbarHeight()):0;t.each(this.sidebars,function(t,a){var d=a.$parent[0].getBoundingClientRect(),n=a.$body[0].getBoundingClientRect(),b=null;return n.height+o.settings.min_height_diff>=d.height||a.$elem.hasClass("sticky-sidebar-xl")&&"xl"!==theme.current.bp?(o._startAction(1,a,function(){o._resetSidebar(a)}),a.parent_pos=d,void(a.body_pos=n)):(a.disable_offsets&&(i=0,r=0),"listener-enable"===e?(a.$elem.addClass("sidebar-fixed-top"),a.$elem.removeClass("sidebar-offset-top sidebar-fixed-bottom sidebar-static-bottom"),a.$body.css({width:a.$elem.width()+"px",top:n.top+"px",bottom:"","margin-top":""}),a.state=null,a.parent_pos=d,void(a.body_pos=n)):"listener-process"===e?(n.height>=d.height?o._startAction(1,a,function(){o._resetSidebar(a)}):d.height>a.parent_pos.height&&d.bottom>o.settings.offset+i&&n.top<o.settings.offset+i?(d.bottom<theme.current.height-o.settings.offset-r?b=d.height-n.height:n.top>d.top&&a.parent_pos.bottom<theme.current.height&&(b=d.height-n.height-(d.bottom-theme.current.height)-o.settings.offset-r),b&&b>0&&(a.$elem.removeClass("sidebar-fixed-top sidebar-static-bottom").addClass("sidebar-offset-top"),a.$body.css({width:"",top:"","margin-top":b+"px"}))):d.height<a.parent_pos.height?a.$elem.hasClass("sidebar-fixed-top")&&Math.ceil(d.bottom)<Math.floor(n.bottom)&&(a.$elem.removeClass("sidebar-fixed-top sidebar-offset-top").addClass("sidebar-static-bottom"),a.$body.removeAttr("style")):n.height!==a.body_pos.height&&(d.bottom<theme.current.height-o.settings.offset-r?a.$body.css({top:(n.height-theme.current.height)*-1-(theme.current.height-d.bottom)+"px"}):n.bottom<theme.current.height?n.height>theme.current.height-2*o.settings.offset-i-r?a.$body.css({top:(n.height-theme.current.height)*-1-o.settings.offset-r+"px"}):d.top<o.settings.offset+i&&a.$body.css({top:o.settings.offset+i+"px"}):n.bottom>d.bottom&&a.$body.css({top:(n.height-theme.current.height)*-1-(theme.current.height-d.bottom)+"px"})),a.body_pos=n,void(a.parent_pos=d)):void(o.fixed||(n.height>theme.current.height-2*o.settings.offset-i-r?s>o.current.scroll?Math.floor(n.bottom)>Math.ceil(theme.current.height-o.settings.offset-r)?o._startAction(2,a,function(){d.top<o.settings.offset+i&&!a.$elem.hasClass("sidebar-offset-top")&&(b=d.top-n.top,a.$elem.addClass("sidebar-offset-top")),a.$elem.removeClass("sidebar-fixed-bottom sidebar-static-bottom sidebar-fixed-top"),a.$body.css({width:"",bottom:"",top:""}),b&&(a.$body.css({"margin-top":b*-1+"px"}),b=null)}):Math.floor(d.bottom)>Math.ceil(theme.current.height-o.settings.offset-r)?o._startAction(3,a,function(){a.$body.css({width:a.$elem.width()+"px",bottom:o.settings.offset+r+"px",top:"","margin-top":""}),a.$elem.removeClass("sidebar-static-bottom sidebar-fixed-top sidebar-offset-top").addClass("sidebar-fixed-bottom")}):o._startAction(4,a,function(){a.$elem.removeClass("sidebar-fixed-bottom sidebar-fixed-top sidebar-offset-top").addClass("sidebar-static-bottom"),a.$body.removeAttr("style")}):s<o.current.scroll&&(n.top<o.settings.offset+i?o._startAction(5,a,function(){d.top<o.settings.offset+i&&!a.$elem.hasClass("sidebar-offset-top")&&(b=d.top-n.top,a.$elem.addClass("sidebar-offset-top")),a.$elem.removeClass("sidebar-fixed-top sidebar-fixed-bottom"),a.$body.css({width:"",top:"",bottom:""}),b&&(a.$body.css({"margin-top":b*-1+"px"}),b=null)}):d.top<o.settings.offset+i?o._startAction(6,a,function(){a.$body.css({width:a.$elem.width()+"px",top:o.settings.offset+i+"px",bottom:"","margin-top":""}),a.$elem.removeClass("sidebar-offset-top sidebar-fixed-bottom sidebar-static-bottom").addClass("sidebar-fixed-top")}):o._startAction(1,a,function(){o._resetSidebar(a)})):d.top<o.settings.offset+i?n.height<d.bottom-o.settings.offset-i?o._startAction(7,a,function(){a.$body.css({width:a.$elem.width()+"px",top:o.settings.offset+i+"px",bottom:"","margin-top":""}),a.$elem.removeClass("sidebar-static-bottom sidebar-fixed-bottom sidebar-offset-top").addClass("sidebar-fixed-top")}):o._startAction(8,a,function(){a.$elem.removeClass("sidebar-fixed-top sidebar-offset-top sidebar-fixed-bottom").addClass("sidebar-static-bottom"),a.$body.removeAttr("style")}):o._startAction(1,a,function(){o._resetSidebar(a)}))))}),this.current.scroll=s}}}),theme.StickySidebar=new e},t(function(){theme.StickySidebar()})}(jQueryTheme);